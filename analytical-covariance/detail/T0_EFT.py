# -*- coding: utf-8 -*-
"""
Created on Mon Nov 15 13:03:12 2021

@author: Yansiang
"""

# Here are the expressions used to calculate the tree-level trispectrum
# These (horrible) expressions were copy-pasted from the
# mathematica notebook (Generating_T0_Z12_expressions.nb),
# which shows their derivation

import numpy as np
# from numba import jit

def InitParameters(arr):
    global be, b1, b2, b1EFT, b2EFT, b3EFT, b4EFT, g2
    [be, b1, b2, b1EFT, b2EFT, b3EFT, b4EFT, g2]=arr

# Shot noise term in Eq. 92
# @jit(nopython=True)
def e24o44(u12,k1,k2):
    if(l1==0 and l2==0):
        return((15 + 10*be + 3*be**2)/15.)
    elif(l1==0 and l2==2):
        return((2*be*(7 + 3*be)*(2*k2**2 + 4*k1*k2*u12 + k1**2*(-1 + 3*u12**2)))/(21.*(k1**2 + k2**2 + 2*k1*k2*u12)))
    elif(l1==2 and l2==2):
        return((5*((21 + be*(22 + 9*be))*k1**4*(-1 + 3*u12**2) + 
           (21 + be*(22 + 9*be))*k2**4*(-1 + 3*u12**2) + 
           4*k1**3*k2*u12*(-21 - 16*be - 3*be**2 + 3*(21 + be*(20 + 7*be))*u12**2) + 
           4*k1*k2**3*u12*(-21 - 16*be - 3*be**2 + 3*(21 + be*(20 + 7*be))*u12**2) + 
           2*k1**2*k2**2*(-21 - 22*be - 3*be**2 + (21 + be*(46 + 21*be))*u12**2 + 
              18*(7 + 2*be*(3 + be))*u12**4)))/(42.*(k1**2 + k2**2 + 2*k1*k2*u12)**2))

# First Z1 Z1 Z2 shot noise term in Eq. 91
# @jit(nopython=True)
def e34o44_1(k1,k2):
    if(l1==0 and l2==0):
        if(k1!=k2):
            return((be/3. + (19*be**2)/45. + be**3/5. + be**4/25. + 
                (25*b2*(3 + be)**2 - 4*(5 + be)*(15 + 7*be)*g2)/(450.*b1**2) + 
                (180*be**2*(7 + 3*be)*k1**9*k2 - 480*be**2*(7 + 3*be)*k1**7*k2**3 + 
                8*(35700 + be*(32900 + 3*be*(4627 + 831*be)))*k1**5*k2**5 - 
                480*be**2*(7 + 3*be)*k1**3*k2**7 + 180*be**2*(7 + 3*be)*k1*k2**9 + 
                45*be**2*(7 + 3*be)*(k1**2 - k2**2)**4*(k1**2 + k2**2)*(np.log((k1 - k2)**2) - 2*np.log(k1 + k2)))/
                (352800.*b1*k1**5*k2**5)))
        else:
            return((175*b2*(3 + be)**2 + 14*b1**2*be*(5 + 3*be)*(15 + be*(10 + 3*be)) + 
                2*b1*(1275 + be*(1175 + 9*be*(53 + 9*be))) - 28*(5 + be)*(15 + 7*be)*g2)/(3150.*b1**2))
    if(l1==0 and l2==2):
        if(k1!=k2):
            return((be*(4*k1*k2*(45*b1*be**2*k1**10 + 15*b1*(63 + 4*be*(15 + be))*k1**8*k2**2 - 
                  3*b1*(1155 + be*(1070 + 157*be))*k1**6*k2**4 + 
                  (3920*b2*(3 + be) + b1*(31031 + 3*be*(7558 + 1751*be)) + 
                     112*b1**2*(105 + be*(230 + 9*be*(17 + 4*be))) - 1792*(7 + 2*be)*g2)*k1**4*k2**6 + 
                  15*b1*(63 + 2*(19 - 9*be)*be)*k1**2*k2**8 + 45*b1*be*(2 + 3*be)*k2**10) + 
               45*b1*(k1 - k2)**4*(k1 + k2)**4*
                (be**2*k1**4 + (21 + 5*be*(4 + be))*k1**2*k2**2 + be*(2 + 3*be)*k2**4)*
                (np.log((k1 - k2)**2) - 2*np.log(k1 + k2))))/(141120.*b1**2*k1**5*k2**7))
        else:
            return((be*(245*b2*(3 + be) + b1*(1841 + 9*be*(146 + 33*be)) + 
               7*b1**2*(105 + be*(230 + 9*be*(17 + 4*be))) - 112*(7 + 2*be)*g2))/(2205.*b1**2))
    if(l1==2 and l2==2):
        if(k1!=k2):
            return((4*k1*k2*(315*b1*be**2*(33 + 19*be)*k1**12 - 
                210*b1*be*(-99 + be*(-33 + 16*be))*k1**10*k2**2 - 
                21*b1*be*(2640 + 7*be*(473 + 139*be))*k1**8*k2**4 + 
                4*(4928*b1**2*be**2*(7 + 3*be)*(7 + 6*be) + 
                   b1*(51744 + be*(140525 + 3*be*(102685 + 34648*be))) + 
                   1232*(49*b2*be**2 - (-7 + be)*(21 + 25*be)*g2))*k1**6*k2**6 - 
                21*b1*be*(2640 + 7*be*(473 + 139*be))*k1**4*k2**8 - 
                210*b1*be*(-99 + be*(-33 + 16*be))*k1**2*k2**10 + 315*b1*be**2*(33 + 19*be)*k2**12) + 
             315*b1*be*(k1 - k2)**4*(k1 + k2)**4*(k1**2 + k2**2)*
              (be*(33 + 19*be)*k1**4 + 2*(33 + 5*be*(11 + 4*be))*k1**2*k2**2 + be*(33 + 19*be)*k2**4)*
              (np.log((k1 - k2)**2) - 2*np.log(k1 + k2)))/(4.346496e6*b1**2*k1**7*k2**7))
        else:
            return((686*b2*be**2 + 56*b1**2*be**2*(7 + 3*be)*(7 + 6*be) + 
             4*b1*(147 + be*(350 + 9*be*(89 + 30*be))) - 14*(-7 + be)*(21 + 25*be)*g2)/(3087.*b1**2))

# Second Z1 Z1 Z2 shot noise term in Eq. 91
# @jit(nopython=True)
def e34o44_2(u12,k1,k2):

    if(l1==0 and l2==0):
        return((147*b2*k1*(k1**2 + k2**2 + 2*k1*k2*u12)*
          ((15 + be*(10 + 3*be))*k1**2 + 2*(15 + be*(10 + 3*be))*k1*k2*u12 + 
            k2**2*(15 + be*(10 + be + 2*be*u12**2))) - 
         k2**2*(7*b1**2*be*(k2**3*u12*(3*(1 + be)*(35 + be*(28 + 5*be)) + 
                  4*be**2*(9 + 5*be)*u12**2) + 
               3*k1**2*k2*u12*(-35 + 49*be + 51*be**2 + 15*be**3 + 
                  4*(35 + be*(35 + be*(21 + 5*be)))*u12**2) + 
               k1**3*(-105 - 21*be + 9*be**2 + 5*be**3 + 
                  6*(35 + be*(35 + be*(21 + 5*be)))*u12**2) + 
               3*k1*k2**2*(-35 - 7*be + 15*be**2 + 3*be**3 + 
                  4*(35 + be*(49 + 6*be*(4 + be)))*u12**2 + 8*be**2*(3 + be)*u12**4)) - 
            294*g2*k1*(-1 + u12**2)*((15 + be*(10 + 3*be))*k1**2 + 
               2*(15 + be*(10 + 3*be))*k1*k2*u12 + k2**2*(15 + be*(10 + be + 2*be*u12**2))) + 
            3*b1*(k1**3*(-315 - 175*be - 49*be**2 + 3*be**3 + 
                  2*(525 + be*(455 + be*(161 + 15*be)))*u12**2 + 24*be**2*(7 + 3*be)*u12**4) + 
               k1**2*k2*u12*(105 + 385*be + 175*be**2 + 39*be**3 + 
                  4*(525 + be*(455 + be*(245 + 51*be)))*u12**2 + 24*be**2*(7 + 3*be)*u12**4) + 
               k1*k2**2*(315*(-1 + 8*u12**2) + 
                  be*(-175 + 7*be + 3*be**2 + 4*(595 + be*(224 + 39*be))*u12**2 + 
                     12*be*(35 + 13*be)*u12**4)) + 
               7*k2**3*u12*(105 + be*(105 + be*(35 + 3*be + 4*(7 + 3*be)*u12**2))))))/
       (4410.*b1**2*k1*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
    
    if(l1==0 and l2==2):
        return((231*b2*be*k1*(k1**2 + k2**2 + 2*k1*k2*u12)*
          (2*(7 + 3*be)*k1**2*(-1 + 3*u12**2) + 2*(7 + 3*be)*k1*k2*u12*(1 + 3*u12**2) + 
            k2**2*(7 + be + (21 + 11*be)*u12**2)) - 
         be*k2**2*(-462*g2*k1*(-1 + u12**2)*
             (2*(7 + 3*be)*k1**2*(-1 + 3*u12**2) + 2*(7 + 3*be)*k1*k2*u12*(1 + 3*u12**2) + 
               k2**2*(7 + be + (21 + 11*be)*u12**2)) + 
            7*b1**2*(k2**3*u12*(462 + 3*be*(297 + be*(176 + 25*be)) + 
                  be*(297 + be*(462 + 205*be))*u12**2) + 
               6*k1**2*k2*u12*(-77 - 11*be + 33*be**2 + 15*be**3 + 
                  (308 + be*(407 + 5*be*(66 + 19*be)))*u12**2 + 6*be*(33 + be*(22 + 5*be))*u12**4)\
                + k1**3*(-462 - 33*be - 5*be**3 + 3*(308 + be*(11 + be*(66 + 35*be)))*u12**2 + 
                  36*be*(33 + be*(22 + 5*be))*u12**4) + 
               6*k1*k2**2*(-77 - 55*be + 11*be**2 + 3*be**3 + 
                  (308 + be*(451 + 3*be*(88 + 23*be)))*u12**2 + 2*be*(99 + 2*be*(55 + 17*be))*u12**4
                  )) + 33*b1*(7*k2**3*u12*(21 + 14*be + be**2 + (21 + be*(22 + 9*be))*u12**2) + 
               2*k1**2*k2*u12*(-7 - 10*be + 3*be**2 + 2*(119 + be*(116 + 23*be))*u12**2 + 
                  2*(105 + 78*be + 28*be**2)*u12**4) + 
               k1*k2**2*(-7 + 10*be + be**2 + (385 + be*(290 + 57*be))*u12**2 + 
                  8*(63 + 19*be*(3 + be))*u12**4) + 
               2*k1**3*(28 + 10*be + (-91 + be*(-40 + 3*be))*u12**2 + 
                  2*(105 + 2*be*(39 + 5*be))*u12**4 + 12*be**2*u12**6))))/
       (9702.*b1**2*k1*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
    
    if(l1==2 and l2==2):
        return((15015*b2*k1*(k1**2 + k2**2 + 2*k1*k2*u12)*
          ((21 + be*(22 + 9*be))*k1**2*(-1 + 3*u12**2) + 
            2*k1*k2*u12*(-21 - 16*be - 3*be**2 + 3*(21 + be*(20 + 7*be))*u12**2) + 
            k2**2*(-21 + 63*u12**2 + be*(-22 - be + (66 + 7*be)*u12**2 + 12*be*u12**4))) - 
         5*k2**2*(7*b1**2*be*(k2**3*u12*(-3*(715 + be*(1287 + be*(533 + 25*be))) + 
                  (11583 + be*(27027 + be*(16809 + 2885*be)))*u12**2 + 120*be**2*(39 + 25*be)*u12**4)
                 + 3*k1**2*k2*u12*(2431 - be*(1001 + be*(923 + 75*be)) - 8437*u12**2 + 
                  be*(5291 + 5*be*(1729 + 577*be))*u12**2 + 
                  12*(1287 + be*(1573 + 2*be*(507 + 125*be)))*u12**4) + 
               3*k1*k2**2*(1573 + 1001*be - 325*be**2 - 33*be**3 + 
                  (-7579 + be*(-5291 + 3*be*(793 + 257*be)))*u12**2 + 
                  4*(3861 + be*(6864 + be*(3679 + 998*be)))*u12**4 + 120*be**2*(26 + 9*be)*u12**6) + 
               k1**3*(be*(429 - 5*be*(39 + 29*be)) + 3*be*(-2717 + be*(-403 + 245*be))*u12**2 + 
                  18*(1287 + be*(1716 + be*(1183 + 290*be)))*u12**4 + 429*(11 - 43*u12**2))) - 
            6006*g2*k1*(-1 + u12**2)*((21 + be*(22 + 9*be))*k1**2*(-1 + 3*u12**2) + 
               2*k1*k2*u12*(-21 - 16*be - 3*be**2 + 3*(21 + be*(20 + 7*be))*u12**2) + 
               k2**2*(-21 + 63*u12**2 + be*(-22 - be + (66 + 7*be)*u12**2 + 12*be*u12**4))) + 
            39*b1*(k1**3*(693 + 605*be + 275*be**2 - 5*be**3 + 
                  (-4389 + be*(-4961 + be*(-1859 + 9*be)))*u12**2 + 
                  2*(3465 + be*(4719 + be*(2079 + 185*be)))*u12**4 + 48*be**2*(33 + 17*be)*u12**6) + 
               k1*k2**2*(693 + 605*be - 77*be**2 - 5*be**3 - 
                  11*(693 + be*(829 + be*(155 + 3*be)))*u12**2 + 
                  8*(2079 + be*(2970 + be*(1287 + 244*be)))*u12**4 + 72*be**2*(55 + 23*be)*u12**6) + 
               k1**2*k2*u12*(-(be*(1727 + be*(737 + 41*be))) + 
                  be*(-583 + be*(1199 + 463*be))*u12**2 + 
                  4*(3465 + be*(4389 + be*(2607 + 607*be)))*u12**4 + 144*be**2*(11 + 5*be)*u12**6 - 
                  231*(1 + 17*u12**2)) + 7*k2**3*u12*
                (231*(-1 + 3*u12**2) + be*
                   (363*(-1 + 3*u12**2) + 
                     be*(-121 - 5*be + (451 + 39*be)*u12**2 + 8*(33 + 17*be)*u12**4))))))/
       (252252.*b1**2*k1*(k1**2 + k2**2 + 2*k1*k2*u12)**2))

# First Z1^2 Z2^2 term in Eq. 25
# @jit(nopython=True)
def e44o44_1(u12,k1,k2):

    if(l1==0 and l2==0):
        return((147147*b2**2*(15 + be*(10 + 3*be)) + 
         (2002*b2*k2**2*(294*(15 + be*(10 + 3*be))*g2*k1*(-1 + u12**2) + 
              7*b1**2*be*((105 + be*(21 - be*(9 + 5*be)))*k1 - 
                 3*(1 + be)*(35 + be*(28 + 5*be))*k2*u12 - 
                 6*(35 + be*(35 + be*(21 + 5*be)))*k1*u12**2 - 4*be**2*(9 + 5*be)*k2*u12**3) + 
              3*b1*(k1*(315 + 175*be + 49*be**2 - 3*be**3 - 
                    2*(525 + be*(455 + be*(161 + 15*be)))*u12**2 - 24*be**2*(7 + 3*be)*u12**4) + 
                 7*k2*u12*(-105 + be*(-105 - be*(35 + 3*be + 4*(7 + 3*be)*u12**2))))))/
          (k1*(k1**2 + k2**2 + 2*k1*k2*u12)) + 
         (k2**4*(588588*(15 + be*(10 + 3*be))*g2**2*k1**2*(-1 + u12**2)**2 + 
              49*b1**4*be**2*(k1**2*(9009 - 858*be**2 + 105*be**4 + 
                    4*(-6006 + be*(-1287 + be*(1144 + 105*be*(13 + 4*be))))*u12**2 + 
                    8*(3003 + be*(3861 + be*(3289 + 105*be*(13 + 2*be))))*u12**4) + 
                 2*k1*k2*u12*(3003*(-1 + 4*u12**2) + 2574*be*(-1 + 11*u12**2) + 
                    910*be**3*(3 + 11*u12**2 + 4*u12**4) + 105*be**4*(5 + 20*u12**2 + 8*u12**4) + 
                    286*be**2*(11 + 78*u12**2 + 16*u12**4)) + 
                 k2**2*(3003*(1 + 2*u12**2) + 5148*be*(1 + 4*u12**2) + 
                    780*be**3*(1 + 12*u12**2 + 8*u12**4) + 286*be**2*(11 + 78*u12**2 + 16*u12**4) + 
                    15*be**4*(5 + 90*u12**2 + 120*u12**4 + 16*u12**6))) + 
              182*b1**3*be*(k1**2*(3465 + 3*be**2*(-132 + be*(-44 + 5*be)) + 
                    2*(-9240 + be*(-6006 + be*(-1485 + be*(176 + 135*be))))*u12**2 + 
                    12*(1925 + be*(2618 + be*(1617 + 4*be*(154 + 25*be))))*u12**4 + 
                    144*be**2*(33 + be*(22 + 5*be))*u12**6) + 
                 7*k2**2*u12**2*(1155 + be*
                     (2772 + 3*be*(726 + 5*be*(44 + 5*be)) + 8*be*(99 + 5*be*(22 + 5*be))*u12**2 + 
                       40*be**3*u12**4)) + 
                 2*k1*k2*u12*(1155*(-5 + 12*u12**2) + 462*be*(-13 + 55*u12**2) + 
                    308*be**3*(1 + 18*u12**2 + 16*u12**4) + 99*be**2*(-11 + 161*u12**2 + 60*u12**4) + 
                    5*be**4*(18 + 191*u12**2 + 208*u12**4 + 24*u12**6))) + 
              143*b1**2*(14*k1*k2*u12*(-945 + 
                    3*be*(-280 - 70*be + be**3 + 14*(1 + be)*(35 + be*(28 + 5*be))*g2) + 
                    14*(225 + 3*be*(90 + be*(36 + be*(6 + be))) + 
                       be*(-105 + be*(-189 + be*(-63 + 5*be)))*g2)*u12**2 - 
                    8*be**2*(-168 + 63*be*(-2 + g2) + be**2*(-19 + 35*g2))*u12**4 + 48*be**4*u12**6)\
                  + 49*k2**2*u12**2*(315 + 
                    be*(420 + 3*be*(70 + be*(12 + be)) + 24*be*(7 + be*(6 + be))*u12**2 + 
                       8*be**3*u12**4)) + 
                 k1**2*(315*(3 - 10*u12**2)**2 - 
                    420*be*(-3 + 49*g2 + (34 - 147*g2)*u12**2 + 2*(-40 + 49*g2)*u12**4) - 
                    42*be**2*(-9 + 98*g2 + 2*(50 - 539*g2)*u12**2 + 4*(-73 + 245*g2)*u12**4 - 
                       240*u12**6) - 36*be**3*
                     (1 - 49*g2 + (2 - 637*g2)*u12**2 + 14*(-4 + 49*g2)*u12**4 - 192*u12**6) + 
                    be**4*(1 + 6*u12**2)*(3 + 980*g2 + 14*(3 - 70*g2)*u12**2 + 152*u12**4 + 48*u12**6)))\
               - 12012*b1*g2*k1*(-1 + u12**2)*
               (k1*(-315 - 175*be - 49*be**2 + 3*be**3 + 
                    2*(525 + be*(455 + be*(161 + 15*be)))*u12**2 + 24*be**2*(7 + 3*be)*u12**4) + 
                 7*k2*u12*(105 + be*(105 + be*(35 + 3*be + 4*(7 + 3*be)*u12**2))))))/
          (k1**2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))/(8.82882e6*b1**4))
          
    if(l1==0 and l2==2):
        return((be*(42042*b2**2*(7 + 3*be)*k1**2*(k1**2 + k2**2 + 2*k1*k2*u12)**2*(-1 + 3*u12**2) - 
           182*b2*k1*k2**2*(k1**2 + k2**2 + 2*k1*k2*u12)*
            (-924*(7 + 3*be)*g2*k1*(1 - 4*u12**2 + 3*u12**4) + 
              66*b1*(7*k2*u12*(-2*be + (21 + be*(20 + 3*be))*u12**2 + 2*be**2*u12**4) + 
                 k1*(28 + 10*be + (-91 + be*(-40 + 3*be))*u12**2 + 
                    2*(105 + 2*be*(39 + 5*be))*u12**4 + 12*be**2*u12**6)) + 
              7*b1**2*(k1*(-462 - 33*be - 5*be**3 + 3*(308 + be*(11 + be*(66 + 35*be)))*u12**2 + 
                    36*be*(33 + be*(22 + 5*be))*u12**4) + 
                 2*k2*u12*(231 + 297*be*(1 + u12**2) + 99*be**2*(1 + 4*u12**2) + 
                    5*be**3*(3 + u12**2)*(1 + 6*u12**2)))) + 
           k2**4*(168168*(7 + 3*be)*g2**2*k1**2*(-1 + u12**2)**2*(-1 + 3*u12**2) - 
              24024*b1*g2*k1*(-1 + u12**2)*
               (7*k2*u12*(-2*be + (21 + be*(20 + 3*be))*u12**2 + 2*be**2*u12**4) + 
                 k1*(28 + 10*be + (-91 + be*(-40 + 3*be))*u12**2 + 
                    2*(105 + 2*be*(39 + 5*be))*u12**4 + 12*be**2*u12**6)) + 
              49*b1**4*be*(4*k1**2*(-39*(-33 + be**2) + 
                    (-4719 + be*(-1287 + be*(-572 + 105*be*(1 + be))))*u12**2 + 
                    (4719 + be*(2145 + be*(2951 + 105*be*(17 + 4*be))))*u12**4 + 
                    12*be*(286 + be*(260 + 7*be*(15 + 2*be)))*u12**6) + 
                 2*k1*k2*u12*(858*(-5 + 11*u12**2) + 429*be*(-11 + 35*u12**2 + 16*u12**4) + 
                    13*be**2*(-31 + 747*u12**2 + 964*u12**4) + 
                    21*be**4*(5 + 55*u12**2 + 64*u12**4 + 8*u12**6) + 
                    5*be**3*(87 + 1069*u12**2 + 1220*u12**4 + 144*u12**6)) + 
                 k2**2*(429*(1 + 11*u12**2) + 
                    be*(be*(572 + 15*be*(10 + be)) + 3*be*(3952 + 15*be*(98 + 13*be))*u12**2 + 
                       4*(858 + be*(2353 + 15*be*(122 + 27*be)))*u12**4 + 
                       24*be**2*(30 + 23*be)*u12**6 + 858*(1 + 15*u12**2)))) - 
              26*b1**2*(-49*k2**2*u12**2*(231*(1 + 3*u12**2) + 
                    be*(3*(55 + be*(11 + be)) + 3*(341 + be*(165 + 23*be))*u12**2 + 
                       4*be*(33 + 17*be)*u12**4)) + 
                 14*k1*k2*u12*(231*(-1 + 3*u12**2 - 30*u12**4 + 14*g2*(-1 + u12**2)) - 
                    33*be**2*(1 + 9*u12**2 + 98*u12**4 + 32*u12**6 + 42*g2*(1 + 3*u12**2 - 4*u12**4)) + 
                    33*be*(-13 + 27*u12**2 - 266*u12**4 + 126*g2*(-1 + u12**4)) + 
                    be**3*(1 + 6*u12**2)*(-3 - 69*u12**2 - 68*u12**4 + 70*g2*(-3 + 2*u12**2 + u12**4)))\
                  + k1**2*(231*(15 + 196*g2 - (71 + 588*g2)*u12**2 + 8*(20 + 49*g2)*u12**4 - 
                       300*u12**6) - 33*be**2*
                     (1 + (3 + 588*g2)*u12**2 + 84*(1 + 21*g2)*u12**4 + (652 - 2352*g2)*u12**6 + 
                       240*u12**8) + 33*be*
                     (27 - 251*u12**2 + 680*u12**4 - 2220*u12**6 + 
                       98*g2*(-1 + u12)*(1 + u12)*(-1 + u12**2 + 36*u12**4)) + 
                    be**3*(-((1 + 6*u12**2)**2*(3 + 69*u12**2 + 68*u12**4)) + 
                       490*g2*(1 - 22*u12**2 - 15*u12**4 + 36*u12**6)))) + 
              14*b1**3*(k1*k2*u12*(12012*(-5 + 12*u12**2) + 429*be*(-133 + 373*u12**2 + 432*u12**4) + 
                    429*be**2*(-9 + 161*u12**2 + 688*u12**4) + 
                    5*be**4*(81 + 1927*u12**2 + 5108*u12**4 + 1704*u12**6) + 
                    13*be**3*(97 + 3531*u12**2 + 10252*u12**4 + 1800*u12**6)) + 
                 k1**2*(6006*(3 - 16*u12**2 + 20*u12**4) + 
                    15*be**4*(1 + 6*u12**2)*(1 + 57*u12**2 + 128*u12**4 + 24*u12**6) + 
                    429*be*(-9 - 61*u12**2 + 46*u12**4 + 360*u12**6) + 
                    429*be**2*(-1 - 21*u12**2 + 34*u12**4 + 408*u12**6) + 
                    13*be**3*(21 - 131*u12**2 + 2214*u12**4 + 5016*u12**6 + 720*u12**8)) + 
                 14*k2**2*u12**2*(3003 + be*
                     (1287*(5 + 3*u12**2) + 
                       be*(429*(11 + 19*u12**2) + 
                          5*be*(273 + 30*be + (1027 + 185*be)*u12**2 + 4*(39 + 25*be)*u12**4))))))))/
       (1.765764e6*b1**4*k1**2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
    
    if(l1==2 and l2==2):
        return((5*(357357*b2**2*(21 + be*(22 + 9*be))*k1**2*(k1**2 + k2**2 + 2*k1*k2*u12)**2*(-1 + 3*u12**2) - 
           238*b2*k1*k2**2*(k1**2 + k2**2 + 2*k1*k2*u12)*
            (-6006*(21 + be*(22 + 9*be))*g2*k1*(1 - 4*u12**2 + 3*u12**4) + 
              7*b1**2*be*((4719 + be*(429 - 5*be*(39 + 29*be)))*k1 - 
                 3*(715 + be*(1287 + be*(533 + 25*be)))*k2*u12 + 
                 3*(-6149 + be*(-2717 + be*(-403 + 245*be)))*k1*u12**2 + 
                 (11583 + be*(27027 + be*(16809 + 2885*be)))*k2*u12**3 + 
                 18*(1287 + be*(1716 + be*(1183 + 290*be)))*k1*u12**4 + 
                 120*be**2*(39 + 25*be)*k2*u12**5) + 
              39*b1*(k1*(693 + 605*be + 275*be**2 - 5*be**3 + 
                    (-4389 + be*(-4961 + be*(-1859 + 9*be)))*u12**2 + 
                    2*(3465 + be*(4719 + be*(2079 + 185*be)))*u12**4 + 48*be**2*(33 + 17*be)*u12**6)\
                  + 7*k2*u12*(231*(-1 + 3*u12**2) + 
                    be*(363*(-1 + 3*u12**2) + 
                       be*(-121 - 5*be + (451 + 39*be)*u12**2 + 8*(33 + 17*be)*u12**4))))) + 
           k2**4*(1429428*(21 + be*(22 + 9*be))*g2**2*k1**2*(-1 + u12**2)**2*(-1 + 3*u12**2) + 
              49*b1**4*be**2*(k1**2*(-3*(21879 - 374*be**2 + 63*be**4) + 
                    7*(36465 + be*(-2652 + be*(-5882 + 15*be*(-68 + 31*be))))*u12**2 + 
                    28*(-14586 + be*(-3315 + be*(3944 + 15*be*(323 + 100*be))))*u12**4 + 
                    48*(7293 + be*(11713 + be*(10880 + 7*be*(663 + 101*be))))*u12**6) + 
                 2*k1*k2*u12*(7293*(1 - 7*u12**2 + 24*u12**4) + 2652*be*(2 - 21*u12**2 + 189*u12**4) + 
                    21*be**4*(5 + 805*u12**2 + 2224*u12**4 + 728*u12**6) + 
                    68*be**3*(-30 + 1105*u12**2 + 3137*u12**4 + 954*u12**6) + 
                    34*be**2*(-211 + 2277*u12**2 + 13204*u12**4 + 2160*u12**6)) + 
                 k2**2*(7293*(-1 + 7*u12**2 + 12*u12**4) + 2652*be*(-5 + 39*u12**2 + 136*u12**4) + 
                    204*be**3*(-5 + 135*u12**2 + 1040*u12**4 + 552*u12**6) + 
                    34*be**2*(-211 + 2277*u12**2 + 13204*u12**4 + 2160*u12**6) + 
                    9*be**4*(-5 + 435*u12**2 + 3940*u12**4 + 3960*u12**6 + 448*u12**8))) + 
              238*b1**3*be*(k1**2*(3*(-4719 + be*(858 + be*(260 + (134 - 5*be)*be))) + 
                    (102531 + be*(37752 + be*(858 + be*(-3232 + 315*be))))*u12**2 + 
                    6*(-42328 + be*(-40183 + be*(-12597 + be*(863 + 925*be))))*u12**4 + 
                    12*(19305 + be*(34749 + be*(24687 + be*(9821 + 1698*be))))*u12**6 + 
                    144*be**2*(390 + be*(295 + 69*be))*u12**8) + 
                 7*k2**2*u12**2*(429*(-5 + 27*u12**2) + 
                    be*(3*(6 + be)*(-286 + 5*(-26 + be)*be) + 
                       (36036 + be*(33618 + 5*be*(2308 + 323*be)))*u12**2 + 
                       8*be*(1170 + be*(1500 + 379*be))*u12**4 + 504*be**3*u12**6)) + 
                 2*k1*k2*u12*(39*be**2*(-1 + 15*u12**2)*(-41 + 431*u12**2 + 120*u12**4) + 
                    429*be*(47 - 320*u12**2 + 777*u12**4) + 
                    7*be**3*(-89 + 528*u12**2 + 13261*u12**4 + 9540*u12**6) + 
                    be**4*(-45 + 2270*u12**2 + 17281*u12**4 + 15144*u12**6 + 1512*u12**8) + 
                    858*(23 + 54*u12**2*(-2 + 3*u12**2)))) - 
              18564*b1*g2*k1*(-1 + u12**2)*
               (k1*(693 + 605*be + 275*be**2 - 5*be**3 + 
                    (-4389 + be*(-4961 + be*(-1859 + 9*be)))*u12**2 + 
                    2*(3465 + be*(4719 + be*(2079 + 185*be)))*u12**4 + 48*be**2*(33 + 17*be)*u12**6)\
                  + 7*k2*u12*(231*(-1 + 3*u12**2) + 
                    be*(363*(-1 + 3*u12**2) + 
                       be*(-121 - 5*be + (451 + 39*be)*u12**2 + 8*(33 + 17*be)*u12**4)))) + 
              17*b1**2*(49*k2**2*u12**2*(9009*(-1 + 3*u12**2) + 18876*be*(-1 + 3*u12**2) + 
                    858*be**2*(-11 + 41*u12**2 + 24*u12**4) + 156*be**3*(-5 + 39*u12**2 + 136*u12**4) + 
                    be**4*(-33 + 771*u12**2 + 3992*u12**4 + 1080*u12**6)) + 
                 14*k1*k2*u12*(9009*(3 - 19*u12**2 + 30*u12**4) - 
                    858*be*(-44 + 35*g2 + 2*(165 - 112*g2)*u12**2 + 27*(-22 + 7*g2)*u12**4) - 
                    858*be**2*(-11 + 63*g2 + 3*(43 - 168*g2)*u12**2 + (-304 + 441*g2)*u12**4 - 
                       192*u12**6) - 546*be**3*
                     (41*g2 + 2*(5 - 236*g2)*u12**2 + (-78 + 311*g2)*u12**4 + 8*(-34 + 15*g2)*u12**6) + 
                    be**4*(-70*g2*(15 - 592*u12**2 - 23*u12**4 + 600*u12**6) + 
                       (1 + 6*u12**2)*(-33 + 771*u12**2 + 3992*u12**4 + 1080*u12**6))) + 
                 k1**2*(9009*(3 - 10*u12**2)**2*(-1 + 3*u12**2) - 
                    1716*be*(33 - 539*g2 + (-473 + 2646*g2)*u12**2 + 7*(286 - 679*g2)*u12**4 + 
                       6*(-440 + 441*g2)*u12**6) - 
                    858*be**2*(39 - 98*g2 + 5*(-65 + 392*g2)*u12**2 + 2*(782 - 4459*g2)*u12**4 + 
                       36*(-69 + 196*g2)*u12**6 - 1440*u12**8) - 
                    156*be**3*(-5 + 49*u12**2 + 298*u12**4 - 2144*u12**6 - 6528*u12**8 + 
                       49*g2*(5 + 26*u12**2 - 577*u12**4 + 546*u12**6)) + 
                    be**4*(-980*g2*(-1 + u12)*(1 + u12)*(-29 + 147*u12**2 + 1044*u12**4) + 
                       (1 + 6*u12**2)**2*(-33 + 771*u12**2 + 3992*u12**4 + 1080*u12**6)))))))/
       (6.0035976e7*b1**4*k1**2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
       
       
# Second Z1^2 Z2^2 term in Eq. 25
# @jit(nopython=True)
def e44o44_2(u12,k1,k2):

    if(l1==0 and l2==0):
        return((49*b1**4*be**2*k1**2*k2**2*(6*(1001 + be*(858 + be*(286 + 5*be*(26 + 5*be))))*k1*k2 + 
            (-3003 + be*(-2574 + be*(3146 + 105*be*(26 + 5*be))))*(k1**2 + k2**2)*u12 + 
            12*(-1001 + be*(429 + be*(2002 + 5*be*(221 + 45*be))))*k1*k2*u12**2 + 
            2*(6006 + be*(14157 + be*(11154 + 35*be*(143 + 30*be))))*(k1**2 + k2**2)*u12**3 + 
            8*(3003 + 2*be*(2574 + be*(1859 + 5*be*(208 + 45*be))))*k1*k2*u12**4 + 
            8*be**2*(572 + 35*be*(13 + 3*be))*(k1**2 + k2**2)*u12**5 + 
            32*be**2*(143 + 5*be*(13 + 3*be))*k1*k2*u12**6) + 
         182*b1**3*be*k1**2*k2**2*((3465 + be*(1848 + be*(-396 + be*(-44 + 15*be))))*k1*k2 + 
            (-5775 + be*(-6006 + be*(-1089 + 308*be + 90*be**2)))*(k1**2 + k2**2)*u12 + 
            3*(-3465 + be*(1232 + be*(4620 + be*(1716 + 265*be))))*k1*k2*u12**2 + 
            (13860 + be*(25410 + be*(15939 + be*(5544 + 955*be))))*(k1**2 + k2**2)*u12**3 + 
            4*(5775 + be*(8316 + be*(5445 + 3234*be + 650*be**2)))*k1*k2*u12**4 + 
            4*be**2*(1485 + 4*be*(308 + 65*be))*(k1**2 + k2**2)*u12**5 + 
            8*be**2*(792 + 5*be*(88 + 25*be))*k1*k2*u12**6 + 120*be**4*(k1**2 + k2**2)*u12**7) + 
         147147*k1*k2*(b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k1**2*(-1 + u12**2))*
          (b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k2**2*(-1 + u12**2))*
          (15 + be*(10 + be + 2*be*u12**2)) - 
         3003*b1*(2*g2*k1**2*k2**2*(-1 + u12**2)*
             (2*(-315 + be*(-175 + be*(7 + 3*be)))*k1*k2 + 
               7*(105 + be*(105 + be*(35 + 3*be)))*(k1**2 + k2**2)*u12 + 
               20*(105 + be*(91 + 3*be*(7 + be)))*k1*k2*u12**2 + 
               28*be**2*(7 + 3*be)*(k1**2 + k2**2)*u12**3 + 16*be**2*(28 + 9*be)*k1*k2*u12**4) + 
            b2*(k1**2 + k2**2 + 2*k1*k2*u12)*
             ((-315 + be*(-175 + be*(7 + 3*be)))*k1*k2*(k1**2 + k2**2) + 
               7*(105 + be*(105 + be*(35 + 3*be)))*(k1**4 + k2**4)*u12 + 
               10*(105 + be*(91 + 3*be*(7 + be)))*k1*k2*(k1**2 + k2**2)*u12**2 + 
               28*be**2*(7 + 3*be)*(k1**4 + k2**4)*u12**3 + 
               8*be**2*(28 + 9*be)*k1*k2*(k1**2 + k2**2)*u12**4)) - 
         143*b1**2*(49*b2*be*(k1**2 + k2**2 + 2*k1*k2*u12)*
             (3*(-35 + be*(-21 + be*(3 + be)))*k1*k2*(k1**2 + k2**2) + 
               3*(1 + be)*(35 + be*(28 + 5*be))*(k1**4 + k2**4)*u12 + 
               6*(35 + be*(42 + be*(15 + 4*be)))*k1*k2*(k1**2 + k2**2)*u12**2 + 
               4*be**2*(9 + 5*be)*(k1**4 + k2**4)*u12**3 + 
               4*be**2*(9 + 2*be)*k1*k2*(k1**2 + k2**2)*u12**4) + 
            k1**2*k2**2*(-3*(945 + be*(420 - 98*be - 12*be**2 + be**3 + 
                     196*(-35 + be*(-21 + be*(3 + be)))*g2))*k1*k2 - 
               21*(-315 + be*(-280 - 70*be + be**3 + 14*(1 + be)*(35 + be*(28 + 5*be))*g2))*
                (k1**2 + k2**2)*u12 - 3*(-1155 + 
                  be*(420*(5 + 49*g2) + be*
                      (2702 + 564*be + 69*be**2 + 196*(105 + be*(27 + 7*be))*g2)))*k1*k2*u12**2 - 
               98*(225 + 3*be*(90 + be*(36 + be*(6 + be))) + 
                  be*(-105 + be*(-189 + be*(-63 + 5*be)))*g2)*(k1**2 + k2**2)*u12**3 + 
               4*(-7875 + be*(-8400 - be*(4620 + be*(2268 + 395*be)) + 
                     98*(105 + be*(126 + be*(27 + 8*be)))*g2))*k1*k2*u12**4 + 
               56*be**2*(-168 + be*(-126 - 19*be + 7*(9 + 5*be)*g2))*(k1**2 + k2**2)*u12**5 + 
               8*be**2*(-1344 + be*(-864 - 169*be + 98*(9 + 2*be)*g2))*k1*k2*u12**6 - 
               336*be**4*(k1**2 + k2**2)*u12**7 - 288*be**4*k1*k2*u12**8)))/
       (8.82882e6*b1**4*k1*k2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))

    if(l1==0 and l2==2):
        return((be*(21021*k1*k2*(7 + be + (21 + 11*be)*u12**2)*
            (b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k1**2*(-1 + u12**2))*
            (b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k2**2*(-1 + u12**2)) - 
           3003*b1*(b2*(k1**2 + k2**2 + 2*k1*k2*u12)*
               (7*k2**4*u12*(21 + 14*be + be**2 + (21 + be*(22 + 9*be))*u12**2) + 
                 k1*k2**3*(-7 + 10*be + be**2 + (91 + 3*be*(22 + 5*be))*u12**2 + 
                    2*(105 + be*(88 + 27*be))*u12**4) + 
                 14*k1**4*(-2*be*u12 + (21 + be*(20 + 3*be))*u12**3 + 2*be**2*u12**5) + 
                 2*k1**3*k2*(-2*(7 + 2*be) + (-7 + 3*(-4 + be)*be)*u12**2 + 
                    2*(3 + 2*be)*(28 + 5*be)*u12**4 + 12*be**2*u12**6)) + 
              2*g2*k1**2*k2**2*(-1 + u12**2)*
               (7*k2**2*u12*(21 + 14*be + be**2 + (21 + be*(22 + 9*be))*u12**2) + 
                 14*k1**2*(-2*be*u12 + (21 + be*(20 + 3*be))*u12**3 + 2*be**2*u12**5) + 
                 k1*k2*(-35 + 2*be + be**2 + 7*(11 + 3*be*(2 + be))*u12**2 + 
                    2*(273 + be*(230 + 47*be))*u12**4 + 24*be**2*u12**6))) + 
           7*b1**3*k1**2*k2**2*(k2**2*u12*
               (3003*(1 + 27*u12**2) + 429*be*(-43 + 445*u12**2 + 270*u12**4) + 
                 429*be**2*(-35 + 423*u12**2 + 452*u12**4) + 
                 20*be**4*(36 + 655*u12**2 + 1214*u12**4 + 300*u12**6) + 
                 13*be**3*(127 + 5331*u12**2 + 9502*u12**4 + 720*u12**6)) + 
              k1**2*u12*(12012*(-5 + 12*u12**2) + 429*be*(-133 + 373*u12**2 + 432*u12**4) + 
                 429*be**2*(-9 + 161*u12**2 + 688*u12**4) + 
                 5*be**4*(81 + 1927*u12**2 + 5108*u12**4 + 1704*u12**6) + 
                 13*be**3*(97 + 3531*u12**2 + 10252*u12**4 + 1800*u12**6)) + 
              k1*k2*(3003*(3 + 3*u12**2 + 50*u12**4) + 
                 858*be*(1 + 2*u12**2)*(8 + 99*u12**2 + 117*u12**4) + 
                 1716*be**2*(-1 + 62*u12**2 + 213*u12**4 + 146*u12**6) + 
                 26*be**3*(-8 + 1461*u12**2 + 8697*u12**4 + 5170*u12**6 + 360*u12**8) + 
                 5*be**4*(15 + 1371*u12**2 + 8558*u12**4 + 7264*u12**6 + 432*u12**8))) + 
           49*b1**4*be*k1**2*k2**2*(2*k1*k2*
               (429 + 3*be*(143 + be*(52 + 5*be*(5 + be))) + 
                 3*(-286 + be*(1001 + be*(1703 + 5*be*(187 + 39*be))))*u12**2 + 
                 (5577 + be*(10296 + be*(12259 + 20*be*(368 + 81*be))))*u12**4 + 
                 4*be*(858 + be*(1079 + 2*be*(295 + 69*be)))*u12**6) + 
              k1**2*u12*(858*(-5 + 11*u12**2) + 429*be*(-11 + 35*u12**2 + 16*u12**4) + 
                 13*be**2*(-31 + 747*u12**2 + 964*u12**4) + 
                 21*be**4*(5 + 55*u12**2 + 64*u12**4 + 8*u12**6) + 
                 5*be**3*(87 + 1069*u12**2 + 1220*u12**4 + 144*u12**6)) + 
              k2**2*u12*(429*(-1 + 13*u12**2) + 
                 be*(7*be*(221 + 15*be*(11 + 2*be)) + be*(14001 + 35*be*(199 + 42*be))*u12**2 + 
                    4*(858 + be*(1573 + 7*be*(160 + 39*be)))*u12**4 + 429*(1 + 31*u12**2)))) - 
           13*b1**2*(49*b2*(k1**2 + k2**2 + 2*k1*k2*u12)*
               (k1**3*k2*(3*(77 + be*(66 + be*(11 + 2*be))) + 
                    3*(77 + be*(132 + be*(165 + 46*be)))*u12**2 + 
                    2*be*(297 + be*(231 + 68*be))*u12**4) + 
                 2*k1*k2**3*(3*(-77 - 66*be + be**3) + 3*(154 + be*(165 + be*(66 + 23*be)))*u12**2 + 
                    be*(297 + be*(297 + 68*be))*u12**4) + 
                 2*k1**4*u12*(231 + 297*be*(1 + u12**2) + 99*be**2*(1 + 4*u12**2) + 
                    5*be**3*(3 + u12**2)*(1 + 6*u12**2)) + 
                 k2**4*u12*(462 + 297*be*(3 + u12**2) + 66*be**2*(8 + 7*u12**2) + 
                    5*be**3*(15 + 41*u12**2))) + 
              2*k1**2*k2**2*(7*k1**2*u12*(231*(-1 + 3*u12**2 - 30*u12**4 + 14*g2*(-1 + u12**2)) - 
                    33*be**2*(1 + 9*u12**2 + 98*u12**4 + 32*u12**6 + 42*g2*(1 + 3*u12**2 - 4*u12**4)) + 
                    33*be*(-13 + 27*u12**2 - 266*u12**4 + 126*g2*(-1 + u12**4)) + 
                    be**3*(1 + 6*u12**2)*(-3 - 69*u12**2 - 68*u12**4 + 70*g2*(-3 + 2*u12**2 + u12**4)))\
                  - 7*k2**2*u12*(231*(-5 + 9*u12**2 + 24*u12**4 - 14*g2*(-1 + u12**2)) + 
                    be**3*(3 + 87*u12**2 + 482*u12**4 + 408*u12**6 + 
                       35*g2*(15 + 26*u12**2 - 41*u12**4)) - 
                    33*be*(23 - 5*u12**2*(9 + 46*u12**2) + 63*g2*(-3 + 2*u12**2 + u12**4)) - 
                    33*be**2*(1 - 5*u12**2 - 8*u12**4*(14 + 3*u12**2) + 14*g2*(-8 + u12**2 + 7*u12**4)))\
                  + k1*k2*(231*(-3 + 49*g2 - 6*(4 + 49*g2)*u12**2 + 5*(-25 + 49*g2)*u12**4 - 
                       240*u12**6) + be**3*(3 + 69*u12**2 + 68*u12**4)*
                     (-1 - 61*u12**2 - 36*u12**4 + 196*g2*(-1 + u12**2)) + 
                    33*be**2*(49*g2*(-1 + u12)*(1 + u12)*(1 + 27*u12**2 + 32*u12**4) - 
                       (1 + 15*u12**2 + 4*u12**4)*(-1 + 51*u12**2 + 48*u12**4)) + 
                    33*be*(7 - 184*u12**2 - 1403*u12**4 - 1948*u12**6 + 
                       294*g2*(1 - 8*u12**2 + u12**4 + 6*u12**6)))))))/
       (1.765764e6*b1**4*k1*k2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
    
    if(l1==2 and l2==2):
        return((5*(49*b1**4*be**2*k1**2*k2**2*(-6*(2431 + be*(2210 + be*(374 + 5*be*(34 + 3*be))))*k1*k2 + 
              (7293 + be*(5304 + be*(-7174 + 15*be*(-136 + 7*be))))*(k1**2 + k2**2)*u12 + 
              6*(26741 + be*(28288 + be*(7514 + 5*be*(952 + 261*be))))*k1*k2*u12**2 + 
              (-51051 + be*(-55692 + be*(77418 + 5*be*(15028 + 3381*be))))*(k1**2 + k2**2)*u12**3 + 
              4*(-58344 + be*(5967 + be*(130016 + 5*be*(16099 + 3546*be))))*k1*k2*u12**4 + 
              4*(43758 + be*(125307 + be*(112234 + be*(53329 + 11676*be))))*(k1**2 + k2**2)*u12**5 + 
              16*(21879 + be*(45084 + be*(34306 + be*(19924 + 4455*be))))*k1*k2*u12**6 + 
              24*be**2*(3060 + be*(2703 + 637*be))*(k1**2 + k2**2)*u12**7 + 
              288*be**2*(255 + 7*be*(17 + 4*be))*k1*k2*u12**8) + 
           238*b1**3*be*k1**2*k2**2*(-((14157 + be*(11154 + be*(-780 + be*(46 + 15*be))))*k1*k2) - 
              (-19734 + be*(-20163 + be*(-1599 + be*(623 + 45*be))))*(k1**2 + k2**2)*u12 + 
              12*(7293 + be*(4147 + be*(-2626 + be*(-419 + 35*be))))*k1*k2*u12**2 + 
              2*(-46332 + be*(-68640 + be*(-20397 + be*(1848 + 1135*be))))*(k1**2 + k2**2)*u12**3 + 
              (-172887 + be*(-43758 + be*(198432 + be*(91014 + 16855*be))))*k1*k2*u12**4 + 
              (138996 + be*(333333 + be*(247455 + be*(92827 + 17281*be))))*(k1**2 + k2**2)*u12**5 + 
              20*(11583 + be*(21879 + be*(15717 + be*(9631 + 2080*be))))*k1*k2*u12**6 + 
              12*be**2*(5850 + be*(5565 + 1262*be))*(k1**2 + k2**2)*u12**7 + 
              72*be**2*(1040 + be*(650 + 187*be))*k1*k2*u12**8 + 1512*be**4*(k1**2 + k2**2)*u12**9) + 
           357357*k1*k2*(b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k1**2*(-1 + u12**2))*
            (b2*(k1**2 + k2**2 + 2*k1*k2*u12) + 2*g2*k2**2*(-1 + u12**2))*
            (-21 + 63*u12**2 + be*(-22 - be + (66 + 7*be)*u12**2 + 12*be*u12**4)) - 
           4641*b1*(2*g2*k1**2*k2**2*(-1 + u12**2)*
               (-2*(-693 + be*(-605 + be*(77 + 5*be)))*k1*k2 - 
                 7*(231 + be*(363 + be*(121 + 5*be)))*(k1**2 + k2**2)*u12 + 
                 2*(-4389 + be*(-4961 - 627*be + 9*be**2))*k1*k2*u12**2 + 
                 7*(693 + be*(1089 + be*(451 + 39*be)))*(k1**2 + k2**2)*u12**3 + 
                 4*(3465 + be*(4719 + 5*be*(275 + 37*be)))*k1*k2*u12**4 + 
                 56*be**2*(33 + 17*be)*(k1**2 + k2**2)*u12**5 + 96*be**2*(44 + 17*be)*k1*k2*u12**6) + 
              b2*(k1**2 + k2**2 + 2*k1*k2*u12)*
               (-((-693 + be*(-605 + be*(77 + 5*be)))*k1*k2*(k1**2 + k2**2)) - 
                 7*(231 + be*(363 + be*(121 + 5*be)))*(k1**4 + k2**4)*u12 + 
                 (-4389 + be*(-4961 - 627*be + 9*be**2))*k1*k2*(k1**2 + k2**2)*u12**2 + 
                 7*(693 + be*(1089 + be*(451 + 39*be)))*(k1**4 + k2**4)*u12**3 + 
                 2*(3465 + be*(4719 + 5*be*(275 + 37*be)))*k1*k2*(k1**2 + k2**2)*u12**4 + 
                 56*be**2*(33 + 17*be)*(k1**4 + k2**4)*u12**5 + 
                 48*be**2*(44 + 17*be)*k1*k2*(k1**2 + k2**2)*u12**6)) - 
           17*b1**2*(49*b2*be*(k1**2 + k2**2 + 2*k1*k2*u12)*
               (-3*(-1573 + be*(-1287 + be*(65 + 11*be)))*k1*k2*(k1**2 + k2**2) - 
                 3*(715 + be*(1287 + be*(533 + 25*be)))*(k1**4 + k2**4)*u12 + 
                 3*(-6149 + be*(-5577 + be*(429 + 257*be)))*k1*k2*(k1**2 + k2**2)*u12**2 + 
                 (11583 + be*(27027 + be*(16809 + 2885*be)))*(k1**4 + k2**4)*u12**3 + 
                 2*(11583 + be*(18018 + be*(7059 + 1996*be)))*k1*k2*(k1**2 + k2**2)*u12**4 + 
                 120*be**2*(39 + 25*be)*(k1**4 + k2**4)*u12**5 + 
                 360*be**2*(13 + 3*be)*k1*k2*(k1**2 + k2**2)*u12**6) + 
              k1**2*k2**2*(3*(27027 + be*
                     (-6292*(-3 + 49*g2) + 
                       be*(-286*(25 + 882*g2) + be*(-260 + 11*be + 196*(65 + 11*be)*g2))))*k1*k2 + 
                 21*(-9009 + 11*be*(-1144 - 286*be + be**3) + 
                    14*be*(715 + be*(1287 + be*(533 + 25*be)))*g2)*(k1**2 + k2**2)*u12 - 
                 6*(57057 + be*(-18876 - be*(71786 + 3*be*(2548 + 69*be)) + 
                       196*(-3861 + be*(-3432 + be*(247 + 134*be)))*g2))*k1*k2*u12**2 - 
                 7*(-171171 + 3*be*(-94380 + be*(-36894 + be*(-1820 + 191*be))) + 
                    112*be*(1716 + be*(3861 + be*(2301 + 370*be)))*g2)*(k1**2 + k2**2)*u12**3 - 
                 (-1198197 + be*(12012*(-55 + 679*g2) + 
                       be*(793650 + 251628*be + 49835*be**2 + 196*(52767 + be*(12831 + 3221*be))*g2))
                    )*k1*k2*u12**4 - 14*(135135 + 273*be**3*(78 - 311*g2) - 11583*be*(-22 + 7*g2) - 
                    429*be**2*(-304 + 441*g2) + be**4*(4309 + 805*g2))*(k1**2 + k2**2)*u12**5 + 
                 4*(-675675 + be*(-1132560 - be*(709566 + be*(343512 + 68087*be)) + 
                       1274*(891 + be*(1386 + be*(363 + 112*be)))*g2))*k1*k2*u12**6 + 
                 168*be**2*(-6864 + 7*be*(-884 + 390*g2 + be*(-149 + 250*g2)))*(k1**2 + k2**2)*
                  u12**7 + 72*be**2*(-18304 + be*(-14144 - 2911*be + 980*(13 + 3*be)*g2))*k1*k2*
                  u12**8 - 45360*be**4*(k1**2 + k2**2)*u12**9 - 38880*be**4*k1*k2*u12**10))))/
       (6.0035976e7*b1**4*k1*k2*(k1**2 + k2**2 + 2*k1*k2*u12)**2))
    
# Z3 term in Eq. 25
# @jit(nopython=True)
def ez3(k1,k2):
    if(l1==0 and l2==0):
        if(k1!=k2):
            return(-(be*(4*k1*k2*(1155*be**3*k1**14 + 70*be*(693 + be*(891 + 253*be + 9*b1EFT*(198 + be*(132 + 25*be))))*k1**12*k2**2 + 
               21*(11550*(1 + 6*b1EFT) + 770*(19 + 144*b1EFT)*be + 990*(7 + 68*b1EFT)*be**2 + 33*(37 + 720*b1EFT)*be**3 + 4000*b1EFT*be**4)*
                k1**10*k2**4 - 2*(80850*(1 - 60*b1EFT + 84*b2EFT + 84*b4EFT) + 3234*(51 - 1880*b1EFT + 2660*b2EFT + 2660*b4EFT)*be + 
                  4158*(31 - 663*b1EFT + 980*b2EFT + 980*b4EFT)*be**2 + 11*(2845 - 37884*b1EFT + 74088*b2EFT + 74088*b4EFT)*be**3 + 
                  56175*b1EFT*be**4)*k1**8*k2**6 + (662970*(5 + 7*be) + 11*be**2*(232470 + 50797*be) + 
                 3696*b1EFT**2*be*(35 + 3*be*(14 + 5*be))**2 + 12*b1EFT*(256025 + be*(970200 + be*(1086393 + 501886*be + 89370*be**2))))*
                k1**6*k2**8 - 42*(11550 + 385*(29 + 72*b1EFT)*be + 495*(5 + 68*b1EFT)*be**2 + 11*(11 + 920*b1EFT)*be**3 + 665*b1EFT*be**4)*
                k1**4*k2**10 - 35*be*(2772 + be*(3564 + 913*be + 12*b1EFT*(297 + 2*be*(231 + 65*be))))*k1**2*k2**12 - 
               210*be**3*(11 + 15*b1EFT*be)*k2**14) + 105*(k1 - k2)**3*(k1 + k2)**3*
             (11*be**3*k1**10 + 6*be*(77 + 33*be*(3 + be) + b1EFT*be*(198 + be*(132 + 25*be)))*k1**8*k2**2 + 
               2*(1155 + 6930*b1EFT + 11*be*(189 + be*(135 + 34*be)) + 12*b1EFT*be*(924 + be*(693 + 286*be + 50*be**2)))*k1**6*k2**4 + 
               2*(2310 + 484*be**3 + 693*be*(5 + 3*be) + 12*b1EFT*be*(462 + be*(693 + be*(374 + 75*be))))*k1**4*k2**6 + 
               3*be*(308 + be*(396 + 121*be + 4*b1EFT*(99 + 2*be*(77 + 25*be))))*k1**2*k2**8 + 2*be**3*(11 + 15*b1EFT*be)*k2**10)*
             (np.log((k1 - k2)**2) - 2*np.log(k1 + k2))))/(4.07484e7*b1EFT**2*k1**9*k2**7)+ K3kernel(k2, k1))
        else:
            return((2*be*(49*(75*(-3 + 14*b2EFT + 14*b4EFT) - 317*be) - 14*b1EFT**2*be*(35 + 3*be*(14 + 5*be))**2 + 
           be*(-9*be*(959 + 211*be) + 686*b2EFT*(95 + 9*be*(5 + be)) + 686*b4EFT*(95 + 9*be*(5 + be))) - 
           2*b1EFT*(26950 + be*(47285 + 3*be*(11711 + 615*be*(7 + be))))))/(77175.*b1EFT**2) + K3kernel(k2, k1))
                    
    if(l1==0 and l2==2):
        if(k1!=k2):
            return(-(be*(4*k1*k2*(105*be**2*(429 + 442*be + 90*b1EFT*be*(13 + 3*be))*k1**14 + 
               70*be*(4901*be**2 + 429*(33 + 41*be) + 9*b1EFT*(7722 + be*(11154 + be*(4979 + 905*be))))*k1**12*k2**2 + 
               21*(5720*(21 + 32*be) + 39*be**2*(2211 + 358*be) + 10*b1EFT*(72072 + be*(95238 + be*(52338 + be*(23829 + 4547*be)))))*k1**10*
                k2**4 - 26*(924*(70 + 5880*b4EFT + 213*be) + 51744*b2EFT*(7 + 6*be)*(15 + be*(10 + 3*be)) + 
                  be*(be*(168267 + 41290*be) + 51744*b4EFT*(160 + 9*be*(9 + 2*be))) + 
                 3*b1EFT*(-1293600 + be*(-1949794 + be*(-897666 + be*(-119197 + 30145*be)))))*k1**8*k2**6 + 
               (2462460*(14 + 25*be) + 13*be**2*(2907531 + 693898*be) + 192192*b1EFT**2*be*(1 + be)*(7 + 5*be)*(35 + 3*be*(14 + 5*be)) + 
                  6*b1EFT*(5325320 + be*(23621598 + be*(30019990 + be*(15187159 + 2925165*be)))))*k1**6*k2**8 - 
               42*(120120 + 13*be*(8635 + (363 - 301*be)*be) + 5*b1EFT*be*(66924 + be*(77220 + be*(17875 + 53*be))))*k1**4*k2**10 - 
               35*be*(56628 + be*(66495 + 15626*be + 6*b1EFT*(15444 + be*(18603 + 4585*be))))*k1**2*k2**12 - 
               210*be**2*(429 + be*(442 + 15*b1EFT*(39 + 41*be)))*k2**14) + 
            105*(k1 - k2)**3*(k1 + k2)**3*(be**2*(429 + 442*be + 90*b1EFT*be*(13 + 3*be))*k1**10 + 
               6*be*(1573 + 39*be*(55 + 19*be) + b1EFT*(7722 + be*(11154 + be*(5499 + 1025*be))))*k1**8*k2**2 + 
               2*(13*(924 + be*(2376 + be*(1947 + 526*be))) + 6*b1EFT*(12012 + be*(26169 + be*(23595 + be*(11089 + 2075*be)))))*k1**6*k2**4 + 
               2*(24024 + 13*be*(3663 + be*(2508 + 641*be)) + 12*b1EFT*be*(5577 + be*(9867 + be*(5863 + 1275*be))))*k1**4*k2**6 + 
               3*be*(6292 + be*(8151 + 2522*be + 2*b1EFT*(5148 + be*(6721 + 2075*be))))*k1**2*k2**8 + 
               2*be**2*(429 + be*(442 + 15*b1EFT*(39 + 41*be)))*k2**10)*(np.log((k1 - k2)**2) - 2*np.log(k1 + k2))))/
       (2.1189168e8*b1EFT**2*k1**9*k2**7)+ K3kernel(k2, k1))
        else:
            return((4*be*(735*(-3 + 14*b2EFT + 14*b4EFT) - 3976*be - 14*b1EFT**2*be*(1 + be)*(7 + 5*be)*(35 + 3*be*(14 + 5*be)) + 
           be*(-3*be*(823 + 198*be) + 98*b2EFT*(160 + 9*be*(9 + 2*be)) + 98*b4EFT*(160 + 9*be*(9 + 2*be))) - 
           2*b1EFT*(5390 + be*(11095 + be*(9058 + 15*be*(245 + 38*be))))))/(15435.*b1EFT**2) + K3kernel(k2, k1))
    
    if(l1==2 and l2==2):
        if(k1!=k2):
            return(-(be*(4*k1*k2*(14175*be**3*k1**18 + 210*be*(2574 + be*(3978 + 1358*be + 9*b1EFT*(780 + be*(590 + 117*be))))*k1**16*k2**2 + 
               70*(42471 + be*(78507 + be*(53469 + 13886*be)) + 18*b1EFT*(11583 + be*(24453 + be*(19539 + be*(8326 + 1531*be)))))*k1**14*
                k2**4 + 6*(13*be*(13706 + 3*be*(4074 + 689*be)) + 14*b1EFT*(-321750 + be*(-353925 + be*(-31785 + 4*be*(13305 + 4286*be)))))*
               k1**12*k2**6 - 4*(1915914 + be*(3701412 + 768768*b2EFT*(7 + 3*be)*(7 + 6*be) + 768768*b4EFT*(7 + 3*be)*(7 + 6*be) + 
                     be*(2542644 + 666035*be)) + 3*b1EFT*(-1789788 + be*(-11373362 + be*(-11569272 + be*(-2110349 + 463655*be)))))*k1**10*
                k2**8 + 2*(13543530 + 768768*b1EFT**2*be*(1 + be)**2*(7 + 5*be)**2 + be*(43334148 + be*(40555476 + 11332691*be)) + 
                  6*b1EFT*(9971962 + be*(27333306 + be*(31994248 + be*(17984861 + 3763132*be)))))*k1**8*k2**10 + 
               6*(1486485 + be*(1850849 + be*(718263 + 175438*be)) + 14*b1EFT*(-250965 + be*(-225225 + be*(31785 + be*(64520 + 23917*be)))))*
                k1**6*k2**12 - 14*(424710 + be*(669240 + 5*be*(71136 + 16765*be) + 6*b1EFT*(173745 + be*(293085 + 2*be*(76605 + 14966*be)))))*
                k1**4*k2**14 - 105*be*(10296 + be*(15912 + 5027*be + 12*b1EFT*(1170 + be*(2115 + 719*be))))*k1**2*k2**16 - 
               5670*be**3*(5 + 7*b1EFT*be)*k2**18) + 105*(k1 - k2)**3*(k1 + k2)**3*
             (135*be**3*k1**14 + 2*be*(2574 + be*(3978 + 1538*be + 9*b1EFT*(780 + be*(590 + 117*be))))*k1**12*k2**2 + 
               3*(9438 + be*(22022 + 3*be*(6318 + 1907*be)) + b1EFT*(46332 + 4*be*(24453 + be*(22659 + be*(10686 + 1999*be)))))*k1**10*
                k2**4 + 2*(37752 + be*(87516 + be*(71604 + 20299*be)) + 3*b1EFT*(18876 + be*(83226 + be*(111462 + be*(60194 + 12175*be)))))*
                k1**8*k2**6 + (66066 + be*(182754 + be*(163566 + 46543*be)) + 
                 12*b1EFT*(16731 + be*(45903 + be*(55731 + be*(33323 + 7500*be)))))*k1**6*k2**8 + 
               6*(9438 + 286*(68 + 81*b1EFT)*be + 78*(192 + 581*b1EFT)*be**2 + (4318 + 31708*b1EFT)*be**3 + 8135*b1EFT*be**4)*k1**4*k2**10 + 
               be*(10296 + be*(15912 + 5747*be + 12*b1EFT*(1170 + be*(2115 + 803*be))))*k1**2*k2**12 + 54*be**3*(5 + 7*b1EFT*be)*k2**14)*
             (np.log((k1 - k2)**2) - 2*np.log(k1 + k2))))/(1.69513344e8*b1EFT**2*k1**11*k2**9) + K3kernel(k2, k1))
        else:
            return((8*be*(-231 - 14*b1EFT**2*be*(1 + be)**2*(7 + 5*be)**2 + 
           be*(-725 + 28*b2EFT*(7 + 3*be)*(7 + 6*be) + 28*b4EFT*(7 + 3*be)*(7 + 6*be) - 27*be*(25 + 7*be)) - 
           2*b1EFT*(490 + be*(1967 + 5*be*(476 + be*(225 + 38*be))))))/(3087.*b1EFT**2) + K3kernel(k2, k1))
    
def eK3():
    if (l1 == 0 and l2 == 0):
        return(((3 + be)*(2 + (4*be)/3. + (2*be**2)/5.))/(6.*b1**3))
    
    if (l1 == 0 and l2 == 2):
        return((be*(2 + (4*be)/3. + (2*be**2)/5.))/(3.*b1**3))
        
    if (l1 == 2 and l2 == 2):
        return(8.0*be**2*(7.0+3.0*be)/(63.0*b1**3))
    
def K3kernel(k2, k1):
    if (k1 != k2):
        K3 = (b1EFT*(-18*k1**5*k2 + 48*k1**3*k2**3 - 38*k1*k2**5 + 9*(-k1**2 + k2**2)**3*np.log(np.abs((-k1 + k2))/(k1 + k2))))/(504.*k1**3*k2**3)+(b3EFT*(2*k1*k2*(k1**2 + k2**2)*(3*k1**4 - 14*k1**2*k2**2 + 3*k2**4) + 3*(-k1**2 + k2**2)**4*np.log(np.abs((-k1 + k2))/(k1 + k2))))/(756.*k1**5*k2**3)
    else:
        K3 = (-3*b1 - 8*b3EFT)/189.
        
    return (12.0*K3*eK3())